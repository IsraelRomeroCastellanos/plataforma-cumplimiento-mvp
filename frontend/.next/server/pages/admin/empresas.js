"use strict";(()=>{var e={};e.id=740,e.ids=[740,660],e.modules={5903:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{config:()=>x,default:()=>h,getServerSideProps:()=>g,getStaticPaths:()=>b,getStaticProps:()=>u,reportWebVitals:()=>f,routeModule:()=>_,unstable_getServerProps:()=>C,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>j});var s=a(7093),l=a(5244),i=a(1323),n=a(2899),o=a.n(n),d=a(6958),c=a.n(d),p=a(6187),m=e([p]);p=(m.then?(await m)():m)[0];let h=(0,i.l)(p,"default"),u=(0,i.l)(p,"getStaticProps"),b=(0,i.l)(p,"getStaticPaths"),g=(0,i.l)(p,"getServerSideProps"),x=(0,i.l)(p,"config"),f=(0,i.l)(p,"reportWebVitals"),j=(0,i.l)(p,"unstable_getStaticProps"),y=(0,i.l)(p,"unstable_getStaticPaths"),v=(0,i.l)(p,"unstable_getStaticParams"),C=(0,i.l)(p,"unstable_getServerProps"),S=(0,i.l)(p,"unstable_getServerSideProps"),_=new s.PagesRouteModule({definition:{kind:l.x.PAGES,page:"/admin/empresas",pathname:"/admin/empresas",bundlePath:"",filename:""},components:{App:c(),Document:o()},userland:p});t()}catch(e){t(e)}})},5376:(e,r,a)=>{a.d(r,{Z:()=>i});var t=a(997),s=a(1163),l=a(6689);function i(){let[e,r]=(0,l.useState)(null),a=(0,s.useRouter)();if(!e)return null;let i=[];return"admin"===e.role?i.push({label:"Dashboard",href:"/dashboard"},{label:"Gesti\xf3n de Usuarios",href:"/admin/usuarios"},{label:"Gesti\xf3n de Empresas",href:"/admin/empresas"},{label:"Mis Clientes",href:"/cliente/clientes"},{label:"Carga Masiva",href:"/cliente/carga-masiva"},{label:"Barridos",href:"/admin/barridos"},{label:"Matrices de Riesgo",href:"/admin/matrices"},{label:"Cambiar Contrase\xf1a",href:"/cambiar-contrasena"}):"consultor"===e.role?i.push({label:"Dashboard",href:"/dashboard"},{label:"Empresas",href:"/consultor/empresas"},{label:"Mis Clientes",href:"/cliente/clientes"},{label:"Carga Masiva",href:"/cliente/carga-masiva"},{label:"Alertas",href:"/consultor/alertas"},{label:"Reportes",href:"/consultor/reportes"},{label:"Cambiar Contrase\xf1a",href:"/cambiar-contrasena"}):"cliente"===e.role&&i.push({label:"Dashboard",href:"/dashboard"},{label:"Mis Clientes",href:"/cliente/clientes"},{label:"Carga Masiva",href:"/cliente/carga-masiva"},{label:"Transacciones",href:"/cliente/transacciones"},{label:"Reportes",href:"/cliente/reportes"},{label:"Cambiar Contrase\xf1a",href:"/cambiar-contrasena"}),(0,t.jsxs)("nav",{style:{backgroundColor:"#1e40af",padding:"1rem",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("div",{children:t.jsx("h2",{style:{margin:0,fontSize:"1.2rem"},children:"admin"===e.role?"Consola Administrativa":"consultor"===e.role?"Panel Consultor":"Portal Cliente"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.9rem"},children:[e.email," (",e.role,")"]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[i.map(e=>t.jsx("button",{onClick:()=>a.push(e.href),style:{color:"white",background:"none",border:"none",cursor:"pointer",textDecoration:a.pathname===e.href?"underline":"none"},children:e.label},e.href)),t.jsx("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a.push("/login")},style:{color:"#f87171",background:"none",border:"none",cursor:"pointer"},children:"Cerrar Sesi\xf3n"})]})]})]})}},6187:(e,r,a)=>{a.a(e,async(e,t)=>{try{a.r(r),a.d(r,{default:()=>c});var s=a(997),l=a(6689),i=a(1163),n=a(9648),o=a(5376),d=e([n]);function c(){let[e,r]=(0,l.useState)([]),[a,t]=(0,l.useState)(""),[d,c]=(0,l.useState)(!1),[p,m]=(0,l.useState)(!1),[h,u]=(0,l.useState)(null),[b,g]=(0,l.useState)({nombre_legal:"",rfc:"",tipo_entidad:"persona_moral"});(0,i.useRouter)();let x=e=>{let{name:r,value:a}=e.target;g(e=>({...e,[r]:a}))},f=e=>{u(e.id),g({nombre_legal:e.nombre_legal,rfc:e.rfc||"",tipo_entidad:e.tipo_entidad}),m(!0)},j=async e=>{e.preventDefault();let a=localStorage.getItem("token");c(!0),t("");try{h?await n.default.put(`/api/admin/empresas/${h}`,b,{headers:{Authorization:`Bearer ${a}`}}):await n.default.post("/api/admin/empresas",b,{headers:{Authorization:`Bearer ${a}`}});let e=await n.default.get("/api/admin/empresas",{headers:{Authorization:`Bearer ${a}`}});r(e.data.empresas),m(!1)}catch(e){t(e.response?.data?.error||"Error al guardar empresa")}finally{c(!1)}};return(0,s.jsxs)("div",{children:[s.jsx(o.Z,{}),(0,s.jsxs)("div",{style:{padding:"2rem",fontFamily:"sans-serif"},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[s.jsx("h1",{children:"Gesti\xf3n de Empresas"}),s.jsx("button",{onClick:()=>{u(null),g({nombre_legal:"",rfc:"",tipo_entidad:"persona_moral"}),m(!0)},style:{padding:"0.5rem 1rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Crear Empresa"})]}),a&&s.jsx("p",{style:{color:"red",marginBottom:"1rem"},children:a}),(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ccc"},children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{children:[s.jsx("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"ID"}),s.jsx("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Nombre Legal"}),s.jsx("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"RFC"}),s.jsx("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Tipo"}),s.jsx("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Acciones"})]})}),s.jsx("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.id}),s.jsx("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.nombre_legal}),s.jsx("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.rfc||"â€”"}),s.jsx("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.tipo_entidad}),s.jsx("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:s.jsx("button",{onClick:()=>f(e),style:{padding:"0.25rem 0.5rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Editar"})})]},e.id))})]}),p&&s.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,s.jsxs)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"8px",width:"500px"},children:[s.jsx("h2",{children:h?"Editar Empresa":"Crear Empresa"}),(0,s.jsxs)("form",{onSubmit:j,children:[s.jsx("div",{style:{marginBottom:"1rem"},children:(0,s.jsxs)("label",{children:["Nombre Legal: ",s.jsx("input",{name:"nombre_legal",value:b.nombre_legal,onChange:x,required:!0,style:{width:"100%",padding:"0.5rem",marginTop:"0.25rem"}})]})}),s.jsx("div",{style:{marginBottom:"1rem"},children:(0,s.jsxs)("label",{children:["RFC: ",s.jsx("input",{name:"rfc",value:b.rfc,onChange:x,style:{width:"100%",padding:"0.5rem",marginTop:"0.25rem"}})]})}),s.jsx("div",{style:{marginBottom:"1rem"},children:(0,s.jsxs)("label",{children:["Tipo de Entidad:",(0,s.jsxs)("select",{name:"tipo_entidad",value:b.tipo_entidad,onChange:x,style:{width:"100%",padding:"0.5rem",marginTop:"0.25rem"},children:[s.jsx("option",{value:"persona_fisica",children:"Persona F\xedsica"}),s.jsx("option",{value:"persona_moral",children:"Persona Moral"})]})]})}),(0,s.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[s.jsx("button",{type:"submit",disabled:d,style:{padding:"0.5rem 1rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:d?"Guardando...":h?"Actualizar":"Crear"}),s.jsx("button",{type:"button",onClick:()=>m(!1),style:{padding:"0.5rem 1rem",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Cancelar"})]})]})]})})]})]})}n=(d.then?(await d)():d)[0],t()}catch(e){t(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},9648:e=>{e.exports=import("axios")}};var r=require("../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[899,125],()=>a(5903));module.exports=t})();