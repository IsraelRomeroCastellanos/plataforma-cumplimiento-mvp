(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[360],{9823:function(e,r,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cliente/clientes",function(){return a(2689)}])},5376:function(e,r,a){"use strict";a.d(r,{Z:function(){return n}});var t=a(5893),l=a(1163),i=a(7294);function n(){let[e,r]=(0,i.useState)(null),a=(0,l.useRouter)();if((0,i.useEffect)(()=>{let e=localStorage.getItem("user");e?r(JSON.parse(e)):a.push("/login")},[a]),!e)return null;let n=[];return"admin"===e.role?n.push({label:"Dashboard",href:"/dashboard"},{label:"Gesti\xf3n de Usuarios",href:"/admin/usuarios"},{label:"Gesti\xf3n de Empresas",href:"/admin/empresas"},{label:"Mis Clientes",href:"/cliente/clientes"},{label:"Carga Masiva",href:"/cliente/carga-masiva"},{label:"Barridos",href:"/admin/barridos"},{label:"Matrices de Riesgo",href:"/admin/matrices"},{label:"Cambiar Contrase\xf1a",href:"/cambiar-contrasena"}):"consultor"===e.role?n.push({label:"Dashboard",href:"/dashboard"},{label:"Empresas",href:"/consultor/empresas"},{label:"Mis Clientes",href:"/cliente/clientes"},{label:"Carga Masiva",href:"/cliente/carga-masiva"},{label:"Alertas",href:"/consultor/alertas"},{label:"Reportes",href:"/consultor/reportes"},{label:"Cambiar Contrase\xf1a",href:"/cambiar-contrasena"}):"cliente"===e.role&&n.push({label:"Dashboard",href:"/dashboard"},{label:"Mis Clientes",href:"/cliente/clientes"},{label:"Carga Masiva",href:"/cliente/carga-masiva"},{label:"Transacciones",href:"/cliente/transacciones"},{label:"Reportes",href:"/cliente/reportes"},{label:"Cambiar Contrase\xf1a",href:"/cambiar-contrasena"}),(0,t.jsxs)("nav",{style:{backgroundColor:"#1e40af",padding:"1rem",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("div",{children:(0,t.jsx)("h2",{style:{margin:0,fontSize:"1.2rem"},children:"admin"===e.role?"Consola Administrativa":"consultor"===e.role?"Panel Consultor":"Portal Cliente"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{marginBottom:"0.5rem",fontSize:"0.9rem"},children:[e.email," (",e.role,")"]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[n.map(e=>(0,t.jsx)("button",{onClick:()=>a.push(e.href),style:{color:"white",background:"none",border:"none",cursor:"pointer",textDecoration:a.pathname===e.href?"underline":"none"},children:e.label},e.href)),(0,t.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a.push("/login")},style:{color:"#f87171",background:"none",border:"none",cursor:"pointer"},children:"Cerrar Sesi\xf3n"})]})]})]})}},2689:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return o}});var t=a(5893),l=a(7294),i=a(1163),n=a(7066),s=a(5376);function o(){let[e,r]=(0,l.useState)([]),[a,o]=(0,l.useState)(""),[c,d]=(0,l.useState)(!0),h=(0,i.useRouter)(),[u,p]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("user"),t=a?JSON.parse(a):{};if(!e||!["admin","consultor","cliente"].includes(t.role)){h.push("/login");return}p(t.role),(async()=>{try{o("");let a=await n.Z.get("/api/cliente/mis-clientes",{headers:{Authorization:"Bearer ".concat(e)}});r(a.data.clientes||[])}catch(e){var a,t;console.error("Error al cargar clientes:",e),o((null===(t=e.response)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.error)||"Error al cargar clientes")}finally{d(!1)}})()},[h]);let m=async(e,a)=>{if("admin"!==u)return;let t="activo"===a?"inactivo":"activo",l=localStorage.getItem("token");try{await n.Z.put("/api/cliente/".concat(e,"/estado"),{estado:t},{headers:{Authorization:"Bearer ".concat(l)}}),r(r=>r.map(r=>r.id===e?{...r,estado:t}:r))}catch(e){var i,s;o((null===(s=e.response)||void 0===s?void 0:null===(i=s.data)||void 0===i?void 0:i.error)||"Error al actualizar estado")}};return c?(0,t.jsxs)("div",{children:[(0,t.jsx)(s.Z,{}),(0,t.jsx)("div",{style:{padding:"2rem"},children:"Cargando..."})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)(s.Z,{}),(0,t.jsxs)("div",{style:{padding:"2rem",fontFamily:"sans-serif"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[(0,t.jsx)("h1",{children:"Mis Clientes"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,t.jsx)("button",{onClick:()=>h.push("/cliente/registrar"),style:{padding:"0.5rem 1rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Registrar Cliente"}),(0,t.jsx)("button",{onClick:()=>h.push("/cliente/carga-masiva"),style:{padding:"0.5rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Carga Masiva"})]})]}),a&&(0,t.jsx)("p",{style:{color:"red",marginBottom:"1rem"},children:a}),0===e.length?(0,t.jsx)("p",{children:"No se encontraron clientes."}):(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #ccc"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"ID"}),(0,t.jsx)("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Nombre"}),(0,t.jsx)("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Tipo"}),(0,t.jsx)("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Actividad"}),(0,t.jsx)("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Estado"}),(0,t.jsx)("th",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.id}),(0,t.jsx)("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.nombre_entidad}),(0,t.jsx)("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.tipo_cliente}),(0,t.jsx)("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:e.actividad_economica}),(0,t.jsx)("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"activo"===e.estado?"✅":"❌"}),(0,t.jsx)("td",{style:{border:"1px solid #ccc",padding:"0.5rem"},children:"admin"===u&&(0,t.jsx)("button",{style:{padding:"0.25rem 0.5rem",backgroundColor:"activo"===e.estado?"#ef4444":"#10b981",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},onClick:()=>m(e.id,e.estado),children:"activo"===e.estado?"Desactivar":"Activar"})})]},e.id))})]})]})]})}},1163:function(e,r,a){e.exports=a(9090)}},function(e){e.O(0,[66,888,774,179],function(){return e(e.s=9823)}),_N_E=e.O()}]);